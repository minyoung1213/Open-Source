# Open-Source
쓰레기 봉투 불법 투기 감지 시스템

YOLOv5 기반 객체 탐지와 MediaPipe 기반의 포즈분류를 결합하여 사람들이 쓰레기봉투를 불법으로 투기하는 행위를 실시간으로 감지하고, 음성 경고를 출력하는 시스템

- 웹캠 기반의 실시간 동작
- 행동 인식 + 객체 인식 결합
- TTS를 통한 경고 출력

1. Pose
   - 목적: 투기 행위 시 발생하는 자세를 기본적인 자세와 구분
   - 세부사항:
     1) Dumping (투기행위): 물체를 땅에 내려놓을 때, 손을 아래로 뻗어 던질 때 나오는 자세의 이미지로 학습
     2) Normal (기본자세): 서기, 팔 흔들며 걸어가기, 팔 뻗는 스트레칭 등의 이미지로 학습
   - 한계: 투기 행위를 pose로만 판단할 수 없음. 물체를 아래쪽으로 던지는 모션을 취할 때 걷기, 뛰기, 우뚝 서기 등 가지각색             의 자세와 연결되기 때문임.
   - 학습 결과 도출:
     1) 상체 기울기에 따라 dumping 행위의 pose로 인식되는 확률이 높았음.
    
2. trash bag 객체 인식
   -  YOLOv5 모델을 사용하여 사진을 학습함
   - 학습할 쓰레기봉투 사진은 roboflow에 올라와 있는 데이터를 사용하여 학습함
   - ![image](https://github.com/user-attachments/assets/38a6ead6-5d58-434e-98ef-30729f0d922a)
   - 동작방식: 웹캠에서 촬영되는 쓰레기 봉투 위치를 실시간으로 탐지
   - 탐지 결과 시각화: 파란색 박스로 trash 객체 표시
  
3. 시스템 동작 방식
   1) 웹캠에서 프레임 수집
   2) MediaPipe로 사람의 포즈 추출 -> PoseClassifier로 행동 분류
   3) YOLOv5로 프레임 내 쓰레기 봉투 탐지
   4) 쓰레기 투기 행위와 쓰레기 객체가 탐지되었을 때 경고 출력
4. 관절 추출 및 투기행위 조건 설계
   MediaPipe Pose를 활용해 주요 관절(손목, 무릎, 엉덩이, 어깨) 좌표를 실시간으로 추출함.
   이를 기반으로 다음과 같은 투기행위 조건을 정의:
   손목이 무릎보다 아래에 위치한 경우 (손 내림)
   엉덩이가 어깨보다 아래인 경우 (허리 굽힘)
   손목이 쓰레기 객체와 접촉하며 움직인 경우 (TrashChecker 활용)
   위 조건 중 하나라도 만족할 경우, gesture_suspected=True로 판단함.
5. 쓰레기 객체 인식 기반 조건 결합
   YOLOv5로 탐지한 쓰레기 봉투와 투기행위 조건을 모두 만족할 경우에만 최종 dumping 상태로 판단
6. 경고 시각 출력 및 음성 알림
   투기행위가 감지되면 화면에 빨간색 dunping 경고 문구 출력
   동시에 pyttsx3를 활용해 "경고. 무단투기 행위가 감지되었습니다." 음성 안내가 1회 재생됨.
   정상 상태(normal)로 돌아가면 초록색 문구로 전환되며, 경고는 다시 초기화되어 중복 방지 로직이 적용됨.
